-- Java & Spring Boot Configuration
return {
  -- Mason registry'yi nvim-java için yapılandır
  {
    "mason-org/mason.nvim",
    opts = {
      registries = {
        "github:nvim-java/mason-registry",
        "github:mason-org/mason-registry",
      },
    },
  },

  {
    "nvim-java/nvim-java",
    ft = { "java" }, -- Java dosyası açıldığında yükle
    dependencies = {
      "nvim-java/lua-async-await",
      "nvim-java/nvim-java-refactor",
      "nvim-java/nvim-java-core",
      "nvim-java/nvim-java-test",
      "nvim-java/nvim-java-dap",
      "MunifTanjim/nui.nvim",
      "neovim/nvim-lspconfig",
      "mfussenegger/nvim-dap",
    },
    config = function()
      require("java").setup({
        -- Spring Boot için özel ayarlar
        spring_boot = {
          enable = true,
        },
        -- Lombok desteği
        jdk = {
          auto_install = false, -- JDK zaten kurulu
        },
        -- Notification ayarları
        notifications = {
          dap = true, -- Debug bildirimleri
        },
        -- JDK runtime path
        java_test = {
          enable = true,
        },
        java_debug_adapter = {
          enable = true,
        },
        root_markers = {
          "settings.gradle",
          "settings.gradle.kts",
          "pom.xml",
          "build.gradle",
          "mvnw",
          "gradlew",
          "build.gradle.kts",
          ".git",
        },
      })
    end,
  },

  {
    "neovim/nvim-lspconfig",
    opts = {
      servers = {
        jdtls = {
          -- JDTLS ayarları nvim-java tarafından yönetiliyor
          setup = function()
            return true -- nvim-java'ya devret
          end,
        },
      },
    },
  },

  -- Formatting için conform.nvim ayarları
  {
    "stevearc/conform.nvim",
    optional = true,
    opts = {
      formatters_by_ft = {
        java = { "google-java-format" },
      },
    },
  },

  -- Mason ile otomatik kurulum
  -- NOT: jdtls, java-test, java-debug-adapter nvim-java tarafından otomatik kurulur
  {
    "mason-org/mason.nvim",
    opts = function(_, opts)
      opts.ensure_installed = opts.ensure_installed or {}
      vim.list_extend(opts.ensure_installed, {
        "google-java-format", -- Google Java Formatter
      })
    end,
  },

  -- Java için keybindings
  {
    "folke/which-key.nvim",
    optional = true,
    opts = {
      spec = {
        { "<leader>cJ", group = "java" },
      },
    },
  },

  -- nvim-dap-ui için
  {
    "rcarriga/nvim-dap-ui",
    optional = true,
    opts = {
      layouts = {
        {
          elements = {
            { id = "scopes", size = 0.25 },
            "breakpoints",
            "stacks",
            "watches",
          },
          size = 40,
          position = "left",
        },
        {
          elements = {
            "repl",
            "console",
          },
          size = 0.25,
          position = "bottom",
        },
      },
    },
  },
}
